<% content_for :stylesheets do %>
<style type="text/css">

body,.container{
  background-color: #000000;
  width: 100%;
  height:100%;
}

h4 {
  color: #ffffff
}

.border_radius{
  border: 2px solid #D6D6D6;
  -webkit-border-radius: 100px;
  -moz-border-radius: 100px;
  border-radius: 100px;
}


.every_writer_box{
  float:left;
  padding-top:22%;
  width:5%;
}

.img_box{
  display:block;
  margin:0 auto;
}

.user_one{
  border:2px solid green;
  width:96px;
  height:96px;
  position:absolute;
}

.user_two{
  border:2px solid yellow;
  width:96px;
  height:96px;
  position:absolute;
}

</style>
<% end %>

<div style="margin:1% 30% 0 30%;min-height:18px;height:2.5%;">
  <canvas id="sketchSecond" data-processing-sources="/assets/timebar.pde"></canvas>
</div>

<div id="user_one"></div>
<div id="user_two"></div>
<span id="second" style="color:red font-size:12px;display:none;" class="badge"><%= @second %>ç§’</span>
<div>
  <div class="every_writer_box">
    <h4 class="text-center"><%= @visitors[0].name %></h4>
    <%= render_gamer_photo(@visitors[0],"thumb",50,50,"img_box") %>
    <br>
    <%#= render_gamer_photo(x,"thumb",50,50) %>
  </div>
  <% alpha = "ABCDEFGHIJKL" %>
  <table id="canvasTable" style="border-collapse:separate;border-spacing:1px 0px;width:65%;float:left;table-layout:auto;">
    <tr>
      <td></td>
      <% (0..11).to_a.each do |x| %>
      <td>
        <h4><%= alpha[x] %></h4>
      </td>
      <% end %>
    </tr>
    <% (1..8).to_a.each do |x| %>
    <tr>
      <td>
        <h4><%= x %></h4>
      </td>
      <% (1..12).to_a.each do |y| %>
      <td>
        <canvas id="origin_<%= x %>_<%= y %>" style="z-index:1;border:1px solid red"></canvas>
      </td>
      <% end %>
    </tr>
    <% end %>
  </table>

  <div class="every_writer_box">
    <h4 class="text-center"><%= @visitors[1].name %></h4>
    <%= render_gamer_photo(@visitors[1],"thumb",50,50,"img_box") %>
    <br>

  </div>
</div>


<% content_for :javascripts do %>
<%= javascript_include_tag 'server_idioms_helpers' %>
<script>

var sketchSecondIns;

function startSetStyle(c) {
  $('#user_photo_'+c).addClass("user_picture_block");
  sketchSecondIns.resetBar();
  sketchSecondIns.doStart();
}

function stopSetStyle(c) {
  $('#user_photo_'+c).removeClass("user_picture_block");
  sketchSecondIns.doStop();
}

window.timeRemaining = parseInt(<%= @second %>);
window.alarm = null;


$(document).ready(function() {
  CM.prop({
    width: 500,
    height: 500,
    lineWidth: 15,
    lineColor: '#ffffff',
    targetZoomScale: 0.035
  });
  <% (1..8).to_a.each do |x| %>
  <% (1..12).to_a.each do |y| %>
  CM.reg('origin_<%= x %>_<%= y %>');
  <% end %>
  <% end %>


  //window.chatApp = new ChatApp(500,500,'0');
  //window.chatApp.bindEvents();

  (function collectGamers() {
    <% @visitors.each do |visitor| %>
    gamers.push('<%= visitor.number %>');
    <% end %>
  })();

  setTimeout(function(){
    if(!sketchSecondIns){
      sketchSecondIns = Processing.getInstanceById('sketchSecond');  
    }
    var p = $(document.getElementById('sketchSecond').parentElement);
    sketchSecondIns.setSize(p.width(), p.height());
    sketchSecondIns.setSecond(<%= @second %>);
  },300);

});
</script>
<% end %>